{
    "contents" : "Лабораторная работа №1\n========================================================\n\nЗадание\n-------------------------\n\nПолучить изображение похожее на исходное с помощью генетического алгорима.\n\nХод работы\n-------------------------\n\nИмпортируем нужные библиотеки и загружаем эталон.\n\n```{r}\nlibrary(\"png\")\nlibrary(\"rgenoud\")\n\nlogo = readPNG(\"homo.png\")\n```\n\n![Эталон](homo.png)\n\nДалее обозначим размеры картинки и количество генов в хромосоме\n\n```{r}\nimageSize=dim(logo)\n\nnrows = imageSize[1]\nncols = imageSize[2]\n\nNum = 4*100\n```\n\nНапишем функцию вывода изображения текущей хромосомы\n\n```{r}\nimageNum=0\n\nDrawImage <- function(xx,filename=\"\")\n{\n  outImageMatrix=matrix(1,nrow=nrows,ncol=ncols)\n  len = length(xx)/4\n  summ=0\n  for (i in 1:len)\n  {\n    x1=xx[(i-1)*4+1]\n    y1=xx[(i-1)*4+2]\n    x2=xx[(i-1)*4+3]\n    y2=xx[(i-1)*4+4]\n    outImageMatrix[y1:y2,x1:x2] = 0 \n  }\n  if (filename==\"\")\n    writePNG(outImageMatrix, sprintf(\"result/%06d.png\",imageNum))\n  else\n    writePNG(outImageMatrix, sprintf(filename,imageNum))\n  imageNum <<- imageNum+1\n}\n```\n\nНапишем фитнес-функцию для генетического алгоритма\n\n```{r}\nf <- function(xx)\n{\n  len = length(xx)/4\n  imageMatrix=matrix(1,nrow=nrows,ncol=ncols)\n  #summ=0\n  for (i in 1:len)\n  {\n    x1=xx[(i-1)*4+1]\n    y1=xx[(i-1)*4+2]\n    x2=xx[(i-1)*4+3]\n    y2=xx[(i-1)*4+4]\n    imageMatrix[y1:y2,x1:x2] = 0 \n    #summ=summ+sum(logo[y1:y2,x1:x2])\n  }\n  sub = imageMatrix-logo\n  sub[sub<0]<-0\n  summ = sum(sub)\n  \n  sub = logo-imageMatrix\n  sub[sub<0]<-0\n  summ = summ + sum(sub)\n  DrawImage(xx)\n  return (summ)\n}\n```\n\nЗапустим генетический алгорим с помощью genoud\n\n```{r}\ndom = c(1,ncols,1,nrows,1,ncols,1,nrows)\nm = matrix(dom,nrow=Num,ncol=2,byrow=TRUE)\n\nres = genoud(fn=f,max.generations=100,nvars=Num,Domains=m,pop.size=100,data.type.int=TRUE,boundary.enforcement=2)\n```\n\nПолучим результат\n```{r}\nrectangles = res$par\n\nDrawImage(rectangles,filename=\"output.png\")\n```\n\n![Результат](output.png)\n",
    "created" : 1395158297012.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1659853778",
    "id" : "56AE7A1F",
    "lastKnownWriteTime" : 1394963983,
    "path" : "~/R/gen/lab2/lab2.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}