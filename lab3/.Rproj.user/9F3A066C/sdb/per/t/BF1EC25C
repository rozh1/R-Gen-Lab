{
    "contents" : "library(\"rgenoud\")\n\nneuron <- function(xxInputs, xxWeights)\n{\n  \n  sum = xxWeights[1]\n  \n  for (i in 1:length(xxInputs))\n  {\n    sum=sum+xxWeights[i+1]*xxInputs[i]\n  }\n  \n  return (1/(1+exp(-sum*5)))\n}\n\nRobot <- function(xxInputs, xxWeights)\n{\n  result = c(0,0,0)\n  len = length(xxWeights)/5\n  for (i in 1:len)\n  {\n    weights = c(xxWeights[(i-1)*5+1],\n                xxWeights[(i-1)*5+2],\n                xxWeights[(i-1)*5+3],\n                xxWeights[(i-1)*5+4],\n                xxWeights[(i-1)*5+5])\n    result[i]=neuron(xxInputs,weights)\n  }\n  return (result)\n}\n\ndata = read.csv(file=\"neurons_data.csv\",header=TRUE,sep=\";\")\ndata\ninputs = data[,1:4]\noutputs = data[,5:7]\n\nNum = 15*1\n\nf <- function(xx)\n{\n  len = length(xx)/15\n  summ=0\n  \n  inputLen = length(inputs[,1])\n  outputColls = length(outputs[1,])\n  \n  for (inputIndex in 1:inputLen)\n  {\n    input = as.vector(as.matrix(inputs[inputIndex,]))\n    for (i in 1:len)\n    {\n      weights = rep(0,15)\n      for (j in 1:15)\n      {\n        weights[j] = xx[(i-1)*15+j]\n      }\n      \n      output = Robot(xxInputs=input,xxWeights=weights)\n      needOutput = as.vector(as.matrix(outputs[inputIndex,]))\n      \n      for(outputIndex in 1:outputColls)\n      {\n        summ = summ + abs(output[outputIndex] - needOutput[outputIndex])\n      }\n    }\n  }\n  return (summ)\n}\n\ndom = c(-1,1)\nm = matrix(dom,nrow=Num,ncol=2,byrow=TRUE)\n\nres = genoud(fn=f,max.generations=50,nvars=Num,Domains=m,pop.size=100,boundary.enforcement=2,BFGS=FALSE,P9=0)\n\nresultWeights = res$par\nresultWeights\nf(resultWeights)\n\n\n  input = as.vector(as.matrix(inputs[1,]))\n\n    Robot(xxInputs=input,xxWeights=resultWeights)\n    as.vector(as.matrix(outputs[1,]))\n  \n\ninput=c(0,0,0,0)\nRobot(xxInputs=input,xxWeights=resultWeights)",
    "created" : 1396363433139.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "247563615",
    "id" : "BF1EC25C",
    "lastKnownWriteTime" : 1397576982,
    "path" : "~/R/gen/lab3/lab3.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}